# LLM Implementation Analysis Template

Use this template when generating analysis reports for LLM codebases.

---

# Analysis: [Model/Framework Name]

**Repository:** [URL or path]
**Framework:** [PyTorch / JAX / Triton / CUDA / etc.]
**Analysis Date:** [YYYY-MM-DD]

---

## 1. Executive Summary

[2-3 sentences describing what this implementation does and its key characteristics]

**Key Features:**
- Feature 1
- Feature 2
- Feature 3

---

## 2. Architecture Overview

### 2.1 System Diagram

```
[ASCII diagram showing high-level architecture]
```

### 2.2 Module Hierarchy

```
Model
├── Embedding
├── Layers (×N)
│   ├── Attention
│   │   ├── QKV Projection
│   │   ├── Attention Compute
│   │   └── Output Projection
│   └── MLP
│       ├── Gate/Up Projection
│       ├── Activation
│       └── Down Projection
└── Output Head
```

### 2.3 Execution Model

[Describe how the model executes: eager, graph-based, megakernel, etc.]

---

## 3. Configuration & Parameters

### 3.1 Model Configuration

| Parameter | Value | Description |
|-----------|-------|-------------|
| `hidden_size` | | |
| `num_layers` | | |
| `num_heads` | | |
| `head_dim` | | |
| `intermediate_size` | | |
| `vocab_size` | | |
| `max_seq_len` | | |

### 3.2 Kernel Configuration

| Parameter | Value | Purpose |
|-----------|-------|---------|
| `BLOCK_M` | | |
| `BLOCK_N` | | |
| `BLOCK_K` | | |
| `NUM_STAGES` | | |
| `NUM_WARPS` | | |

### 3.3 Constraints & Requirements

- Alignment: [requirements]
- Hardware: [minimum GPU arch]
- Precision: [supported dtypes]

---

## 4. Component Analysis

### 4.1 [Component Name: e.g., Attention]

**Purpose:** [What this component does]

**Interface:**
```
INPUTS:
  - tensor_name: [shape], dtype

OUTPUTS:
  - tensor_name: [shape], dtype

PARAMS:
  - param_name: value
```

**Pseudocode:**
```python
def component_name(inputs):
    """
    [Brief description]

    Tiling: [tiling strategy]
    Memory: [memory access pattern]
    """
    # Step 1: ...
    # Step 2: ...
    return outputs
```

**Data Flow:**
```
[ASCII diagram of data flow within component]
```

**Key Insights:**
- Insight 1
- Insight 2

---

### 4.2 [Next Component...]

[Repeat structure for each major component]

---

## 5. Task/Operator Catalog

| ID | Task Type | Purpose | Tiling | Dependencies |
|----|-----------|---------|--------|--------------|
| 1 | | | | |
| 2 | | | | |
| ... | | | | |

---

## 6. Data Flow & Dependencies

### 6.1 Full Forward Pass

```
[ASCII diagram showing complete data flow]
```

### 6.2 Dependency Graph

```
[Task dependency visualization]
```

### 6.3 Memory Lifecycle

| Tensor | Created By | Consumed By | Lifetime |
|--------|------------|-------------|----------|
| | | | |

---

## 7. Parallelism & Distribution

### 7.1 Parallelism Strategy

- **Data Parallelism:** [Yes/No, description]
- **Tensor Parallelism:** [Yes/No, description]
- **Pipeline Parallelism:** [Yes/No, description]
- **Sequence Parallelism:** [Yes/No, description]

### 7.2 Communication Patterns

| Operation | Primitive | When | Data Size |
|-----------|-----------|------|-----------|
| | all_reduce | | |
| | all_gather | | |

### 7.3 Compute-Communication Overlap

[Description of overlap strategy]

---

## 8. Memory & Performance

### 8.1 Memory Access Pattern

```
[Diagram showing memory hierarchy usage]

Global Memory (HBM)
       ↓ load
Shared Memory (SRAM)
       ↓ load
Registers
       ↓ compute
Registers
       ↓ store
Shared Memory (SRAM)
       ↓ store
Global Memory (HBM)
```

### 8.2 Execution Timeline

```
[ASCII timeline showing task execution across SMs]
```

### 8.3 Bottleneck Analysis

- **Compute Bound:** [operations]
- **Memory Bound:** [operations]
- **Synchronization:** [sync points]

---

## 9. Technical FAQ

### Q: How are variable sequence lengths handled?
A: [Answer with code references]

### Q: What is the maximum supported sequence length?
A: [Answer with code references]

### Q: What operations are fused?
A: [Answer with code references]

### Q: What hardware is required?
A: [Answer with code references]

### Q: How does the KV cache work?
A: [Answer with code references]

---

## 10. Key Files Reference

| File | Purpose | Key Functions/Classes |
|------|---------|----------------------|
| | | |

---

## 11. Appendix

### A. Glossary

| Term | Definition |
|------|------------|
| | |

### B. References

- [Related papers]
- [Documentation links]

---

*Generated by LLM Code Analysis Skill*
